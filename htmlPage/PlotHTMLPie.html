<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      type="text/css"
      href="http://finisar-au/departments/labview/styles/chart_style.css"
    />
    <script
      language="javascript"
      type="text/javascript"
      src="http://finisar-au/departments/labview/scripts/jquery.min.js"
    ></script>
    <script src="http://finisar-au/departments/labview/scripts/chart.js"></script>
    <script src="http://finisar-au/departments/labview/scripts/chart_utils.js"></script>
    <script src="http://finisar-au/departments/labview/scripts/json2.js"></script>
    <script src="http://finisar-au/departments/labview/scripts/jquery(v1.11.3).min.js"></script>
    <style>
      #container {
        width: 95vm;
        height: 95vh;
      }
      #canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
      }
    </style>
  </head>

  <body>
    <div id="container">
      <canvas id="canvas"></canvas>
    </div>
    <script type="text/javascript">
      var color = Chart.helpers.color;
      var plotData = {};

      var config = {
        type: "pie",

        data: plotData,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: {
            animateScale: true,
            animateRotate: true,
          },
          legend: {
            display: false,
            position: "right",
          },
          title: {
            display: true,
            text: "INPUT",
          },
          cutoutPercentage: 0,

          tooltips: {
            enabled: true,
            callbacks: {
              title: function (tooltipItems, data) {
                var Title = data.datasets[tooltipItems[0].datasetIndex].label;
                return Title;
              },
              // Use the footer callback to display the % of total of the items showing in the tooltip
              footer: function (tooltipItems, data) {
                console.log(data);
                var ratio = 0;
                var sum = 0;
                var i = 0;
                var length =
                  data.datasets[tooltipItems[0].datasetIndex].data.length;
                for (i = 0; i < length; i++) {
                  sum += data.datasets[tooltipItems[0].datasetIndex].data[i];
                }
                tooltipItems.forEach(function (tooltipItem) {
                  ratio =
                    (100 *
                      data.datasets[tooltipItem.datasetIndex].data[
                        tooltipItem.index
                      ]) /
                    sum;
                  ratio = ratio.toFixed(1);
                });
                return "ratio: " + ratio + "%";
              },
            },
            footerFontStyle: "normal",
          },
        },
      };

      // run plot function here --------------------------
      window.onload = function () {
        var ctx = document.getElementById("canvas").getContext("2d");
        window.myChart = new Chart(ctx, config);
      };
      function UpdatePlot(data) {
        var myData = JSON.parse(data.PlotData);
        config.data = myData;

        config.options.legend.display = data.GenericPlotOptions.LegendDisplay;
        config.options.legend.position = data.GenericPlotOptions.LegendPosition;
        config.options.title.text = data.GenericPlotOptions.GraphTitle;

        config.options.cutoutPercentage = data.PiePlotOptions.cutoutPercentage;

        window.myChart.update();
      }
    </script>
  </body>
</html>
